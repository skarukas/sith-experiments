Training using cuda
Loading training data
Loading validation data
Model Architecture:
SingleLPClassifier(
  (activation): ReLU()
  (dropout): Dropout(p=0.2, inplace=False)
  (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
  (conv_layers): ModuleList(
    (0): Conv2d(1, 32, kernel_size=(7, 7), stride=(1, 1))
    (1): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1))
  )
  (to_out): Linear(in_features=128, out_features=10, bias=True)
  (logpolar): InterpolatedLogPolarTransform(
    ntau=20, tau_range=1:30, ntheta=12, stride=1
    (filterbank): ShiftedConv2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
    )
  )
)
Total parameters: 128010
Profiling model...
Operations sorted by CUDA time:
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               CudnnConvolutionBackward         0.01%     184.000us         1.59%      43.855ms       1.462ms       0.000us         0.00%     261.337ms       8.711ms           0 b           0 b       3.77 Gb           0 b            30  
                       aten::cudnn_convolution_backward         0.02%     474.000us         1.59%      43.671ms       1.456ms       0.000us         0.00%     261.337ms       8.711ms           0 b           0 b       3.77 Gb           0 b            30  
                 aten::cudnn_convolution_backward_input         0.59%      16.137ms         0.71%      19.665ms     983.250us     135.217ms        30.72%     135.217ms       6.761ms           0 b           0 b       3.77 Gb      -1.20 Gb            20  
                aten::cudnn_convolution_backward_weight         0.73%      20.118ms         0.85%      23.532ms     784.400us     126.120ms        28.65%     126.120ms       4.204ms           0 b           0 b       4.83 Mb     -19.69 Gb            30  
void cudnn::detail::dgrad_engine<float, 512, 6, 5, 3...         0.00%       0.000us         0.00%       0.000us       0.000us      99.649ms        22.64%      99.649ms       9.965ms           0 b           0 b           0 b           0 b            10  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us      81.952ms        18.62%      81.952ms       8.195ms           0 b           0 b           0 b           0 b            10  
                                           aten::conv2d         0.01%     161.000us         6.43%     176.979ms       4.424ms       0.000us         0.00%      48.703ms       1.218ms           0 b           0 b       5.98 Gb           0 b            40  
                                      aten::convolution         0.01%     154.000us         6.42%     176.818ms       4.420ms       0.000us         0.00%      48.703ms       1.218ms           0 b           0 b       5.98 Gb           0 b            40  
                                     aten::_convolution         0.02%     496.000us         6.42%     176.664ms       4.417ms       0.000us         0.00%      48.703ms       1.218ms           0 b           0 b       5.98 Gb           0 b            40  
                                aten::cudnn_convolution         6.14%     169.093ms         6.35%     174.911ms       5.830ms      37.911ms         8.61%      37.911ms       1.264ms           0 b           0 b       5.92 Gb      -4.79 Gb            30  
                              aten::adaptive_max_pool2d         0.01%     238.000us         0.01%     334.000us      33.400us      31.481ms         7.15%      31.481ms       3.148ms           0 b           0 b      91.88 Mb      91.88 Mb            10  
void at::native::(anonymous namespace)::adaptivemaxp...         0.00%       0.000us         0.00%       0.000us       0.000us      31.481ms         7.15%      31.481ms       3.148ms           0 b           0 b           0 b           0 b            10  
void cutlass::Kernel<cutlass_tensorop_s1688dgrad_pre...         0.00%       0.000us         0.00%       0.000us       0.000us      26.450ms         6.01%      26.450ms       2.645ms           0 b           0 b           0 b           0 b            10  
                                        aten::clamp_min         0.02%     528.000us         0.12%       3.412ms      56.867us       9.225ms         2.10%      18.450ms     307.500us           0 b           0 b      11.84 Gb           0 b            60  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      18.219ms         4.14%      18.219ms     364.380us           0 b           0 b           0 b           0 b            50  
                                              aten::cat         0.01%     242.000us        73.67%        2.028s      39.006ms       0.000us         0.00%      17.277ms     332.250us           0 b           0 b       3.86 Gb           0 b            52  
                                             aten::_cat         0.03%     758.000us        73.66%        2.028s      39.001ms      17.277ms         3.93%      17.277ms     332.250us           0 b           0 b       3.86 Gb           0 b            52  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.163ms         3.90%      17.163ms     572.100us           0 b           0 b           0 b           0 b            30  
void nchwToNhwcKernel<float, float, float, true, fal...         0.00%       0.000us         0.00%       0.000us       0.000us      15.575ms         3.54%      15.575ms     259.583us           0 b           0 b           0 b           0 b            60  
void fft2d_r2c_16x16<float>(float2*, float const*, i...         0.00%       0.000us         0.00%       0.000us       0.000us      14.484ms         3.29%      14.484ms     362.100us           0 b           0 b           0 b           0 b            40  
                                          ReluBackward0         0.00%     131.000us         0.03%     761.000us      25.367us       0.000us         0.00%      14.005ms     466.833us           0 b           0 b       5.44 Gb    -496.12 Mb            30  
                               aten::threshold_backward         0.01%     394.000us         0.02%     630.000us      21.000us      14.005ms         3.18%      14.005ms     466.833us           0 b           0 b       5.92 Gb       5.92 Gb            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      14.005ms         3.18%      14.005ms     466.833us           0 b           0 b           0 b           0 b            30  
                                  ampere_cgemm_64x32_tn         0.00%       0.000us         0.00%       0.000us       0.000us      13.724ms         3.12%      13.724ms       1.372ms           0 b           0 b           0 b           0 b            10  
                                                batch_4         0.06%       1.552ms         0.13%       3.671ms       3.671ms       0.000us         0.00%      12.784ms      12.784ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_1         0.06%       1.678ms         0.14%       3.806ms       3.806ms       0.000us         0.00%      12.780ms      12.780ms          -4 b          -4 b       1.42 Gb    -998.14 Mb             1  
                                                batch_2         0.06%       1.574ms         0.13%       3.672ms       3.672ms       0.000us         0.00%      12.768ms      12.768ms          -4 b          -4 b       1.42 Gb    -998.14 Mb             1  
                                                batch_3         0.06%       1.581ms         0.13%       3.682ms       3.682ms       0.000us         0.00%      12.766ms      12.766ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_0         0.12%       3.398ms         7.31%     201.176ms     201.176ms       0.000us         0.00%      12.760ms      12.760ms          -4 b          -4 b       1.42 Gb    -998.14 Mb             1  
                                                batch_5         0.06%       1.565ms         0.13%       3.632ms       3.632ms       0.000us         0.00%      12.758ms      12.758ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                          aten::dropout         0.01%     144.000us         0.11%       3.162ms     105.400us       0.000us         0.00%      11.382ms     379.400us           0 b           0 b       7.40 Gb           0 b            30  
                                   aten::_fused_dropout         0.02%     657.000us         0.11%       3.018ms     100.600us      11.382ms         2.59%      11.382ms     379.400us           0 b           0 b       7.40 Gb           0 b            30  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us      11.382ms         2.59%      11.382ms     379.400us           0 b           0 b           0 b           0 b            30  
                                                batch_6         0.06%       1.572ms         0.13%       3.669ms       3.669ms       0.000us         0.00%      11.029ms      11.029ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_7         0.06%       1.572ms         0.13%       3.677ms       3.677ms       0.000us         0.00%      11.027ms      11.027ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_8         0.06%       1.637ms         0.13%       3.675ms       3.675ms       0.000us         0.00%      11.025ms      11.025ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_9         0.06%       1.539ms         0.13%       3.592ms       3.592ms       0.000us         0.00%      11.024ms      11.024ms          -4 b          -4 b       1.42 Gb    -998.14 Mb             1  
                                  ampere_cgemm_64x64_tn         0.00%       0.000us         0.00%       0.000us       0.000us      10.795ms         2.45%      10.795ms       1.079ms           0 b           0 b           0 b           0 b            10  
                                             aten::add_         0.04%     977.000us         0.06%       1.722ms      16.882us      10.681ms         2.43%      10.681ms     104.716us           0 b           0 b           0 b           0 b           102  
                                   FusedDropoutBackward         0.00%     133.000us         0.03%     933.000us      31.100us       0.000us         0.00%      10.278ms     342.600us           0 b           0 b       5.35 Gb    -588.00 Mb            30  
                                    aten::_masked_scale         0.01%     313.000us         0.03%     800.000us      26.667us      10.278ms         2.34%      10.278ms     342.600us           0 b           0 b       5.92 Gb           0 b            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      10.278ms         2.34%      10.278ms     342.600us           0 b           0 b           0 b           0 b            30  
                              AdaptiveMaxPool2DBackward         0.00%      57.000us         0.01%     386.000us      38.600us       0.000us         0.00%       9.981ms     998.100us           0 b           0 b       2.87 Gb           0 b            10  
                     aten::adaptive_max_pool2d_backward         0.00%     119.000us         0.01%     329.000us      32.900us       7.381ms         1.68%       9.981ms     998.100us           0 b           0 b       2.87 Gb       2.87 Gb            10  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us       9.603ms         2.18%       9.603ms     960.300us           0 b           0 b           0 b           0 b            10  
                                             aten::relu         0.01%     285.000us         0.08%       2.126ms      70.867us       0.000us         0.00%       9.225ms     307.500us           0 b           0 b       5.92 Gb           0 b            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       9.225ms         2.10%       9.225ms     307.500us           0 b           0 b           0 b           0 b            30  
                                          SliceBackward         0.00%      58.000us         0.05%       1.249ms      62.450us       0.000us         0.00%       8.946ms     447.300us           0 b           0 b       3.05 Gb           0 b            20  
                                   aten::slice_backward         0.01%     172.000us         0.04%       1.191ms      59.550us       0.000us         0.00%       8.946ms     447.300us           0 b           0 b       3.05 Gb           0 b            20  
void cudnn::cnn::wgrad_alg0_engine<float, 128, 5, 5,...         0.00%       0.000us         0.00%       0.000us       0.000us       8.545ms         1.94%       8.545ms     854.500us           0 b           0 b           0 b           0 b            10  
                                              aten::add         0.01%     267.000us         0.01%     402.000us      20.100us       7.720ms         1.75%       7.720ms     386.000us           0 b           0 b       3.05 Gb       3.05 Gb            20  
void at::native::(anonymous namespace)::atomicadapti...         0.00%       0.000us         0.00%       0.000us       0.000us       7.381ms         1.68%       7.381ms     738.100us           0 b           0 b           0 b           0 b            10  
                                            aten::copy_         0.03%     880.000us         0.06%       1.771ms      18.071us       6.920ms         1.57%       6.920ms      70.612us           0 b           0 b           0 b           0 b            98  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us       6.598ms         1.50%       6.598ms     109.967us           0 b           0 b           0 b           0 b            60  
                                              aten::sum         0.03%     903.000us         0.06%       1.597ms      39.925us       6.242ms         1.42%       6.242ms     156.050us           0 b           0 b      20.00 Kb           0 b            40  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       6.118ms         1.39%       6.118ms     203.933us           0 b           0 b           0 b           0 b            30  
void fft2d_c2r_16x16<float, false>(float*, float2*, ...         0.00%       0.000us         0.00%       0.000us       0.000us       5.868ms         1.33%       5.868ms     293.400us           0 b           0 b           0 b           0 b            20  
                                            aten::fill_         0.03%     884.000us         0.08%       2.075ms      12.809us       5.554ms         1.26%       5.554ms      34.284us           0 b           0 b           0 b           0 b           162  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.554ms         1.26%       5.554ms      34.284us           0 b           0 b           0 b           0 b           162  
                                            aten::zero_         0.02%     586.000us         0.08%       2.285ms      12.486us       0.000us         0.00%       5.523ms      30.180us           0 b           0 b           0 b           0 b           183  
void implicit_convolve_sgemm<float, float, 1024, 5, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.086ms         0.93%       4.086ms     408.600us           0 b           0 b           0 b           0 b            10  
void flip_filter<float, float>(float*, float const*,...         0.00%       0.000us         0.00%       0.000us       0.000us       3.683ms         0.84%       3.683ms     184.150us           0 b           0 b           0 b           0 b            20  
void nhwcToNchwKernel<float, float, float, true, fal...         0.00%       0.000us         0.00%       0.000us       0.000us       3.260ms         0.74%       3.260ms     163.000us           0 b           0 b           0 b           0 b            20  
                                            aten::zeros         0.01%     399.000us         0.08%       2.107ms      20.861us       0.000us         0.00%       2.800ms      27.723us         164 b           0 b       3.08 Gb           0 b           101  
void cudnn::ops::scalePackedTensor_kernel<float, flo...         0.00%       0.000us         0.00%       0.000us       0.000us       1.489ms         0.34%       1.489ms     148.900us           0 b           0 b           0 b           0 b            10  
                                               aten::lt         0.02%     548.000us         0.06%       1.580ms      39.500us     270.000us         0.06%     540.000us      13.500us           0 b           0 b      61.60 Mb           0 b            40  
                                               aten::ge         0.02%     464.000us         0.05%       1.359ms      33.975us     268.000us         0.06%     536.000us      13.400us          -8 b           0 b      61.60 Mb           0 b            40  
                                        aten::remainder         0.02%     424.000us         0.04%     966.000us      48.300us     364.000us         0.08%     364.000us      18.200us           0 b           0 b      61.60 Mb           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     364.000us         0.08%     364.000us      18.200us           0 b           0 b           0 b           0 b            20  
                                               aten::to         0.01%     240.000us         0.05%       1.290ms      16.125us       0.000us         0.00%     334.000us       4.175us           0 b           0 b     246.40 Mb           0 b            80  
                                           aten::gather         0.01%     355.000us         0.03%     948.000us      47.400us     305.000us         0.07%     305.000us      15.250us           0 b           0 b     123.19 Mb           0 b            20  
void at::native::_scatter_gather_elementwise_kernel<...         0.00%       0.000us         0.00%       0.000us       0.000us     305.000us         0.07%     305.000us      15.250us           0 b           0 b           0 b           0 b            20  
                                              aten::max         0.02%     515.000us         0.04%       1.082ms      54.100us     294.000us         0.07%     294.000us      14.700us           0 b           0 b       3.40 Mb           0 b            20  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     294.000us         0.07%     294.000us      14.700us           0 b           0 b           0 b           0 b            20  
                            aten::thnn_conv_depthwise2d         0.00%      45.000us         0.01%     371.000us      37.100us       0.000us         0.00%     293.000us      29.300us           0 b           0 b      57.42 Mb           0 b            10  
                    aten::thnn_conv_depthwise2d_forward         0.01%     231.000us         0.01%     326.000us      32.600us     293.000us         0.07%     293.000us      29.300us           0 b           0 b      57.42 Mb      57.42 Mb            10  
void spatialDepthwiseConvolutionUpdateOutput<float, ...         0.00%       0.000us         0.00%       0.000us       0.000us     293.000us         0.07%     293.000us      29.300us           0 b           0 b           0 b           0 b            10  
                                       aten::bitwise_or         0.01%     298.000us         0.04%       1.100ms      27.500us     144.000us         0.03%     288.000us       7.200us           0 b           0 b      61.60 Mb           0 b            40  
                                          aten::reshape         0.02%     503.000us         0.07%       1.857ms       9.774us       0.000us         0.00%     281.000us       1.479us           0 b           0 b      88.05 Mb           0 b           190  
                                            aten::clone         0.00%      94.000us         0.02%     679.000us      33.950us       0.000us         0.00%     281.000us      14.050us           0 b           0 b      88.05 Mb           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     270.000us         0.06%     270.000us      13.500us           0 b           0 b           0 b           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     268.000us         0.06%     268.000us      13.400us           0 b           0 b           0 b           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     225.000us         0.05%     225.000us      11.250us           0 b           0 b           0 b           0 b            20  
                                            aten::where         0.00%      60.000us         0.02%     562.000us      28.100us       0.000us         0.00%     212.000us      10.600us           0 b           0 b     123.19 Mb           0 b            20  
                                         aten::_s_where         0.01%     247.000us         0.02%     502.000us      25.100us     212.000us         0.05%     212.000us      10.600us           0 b           0 b     123.19 Mb           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     212.000us         0.05%     212.000us      10.600us           0 b           0 b           0 b           0 b            20  
                        torch::autograd::AccumulateGrad         0.01%     313.000us         0.06%       1.745ms      21.812us       0.000us         0.00%     203.000us       2.538us           0 b           0 b      -2.02 Mb      -2.51 Mb            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     182.000us         0.04%     182.000us       2.528us           0 b           0 b           0 b           0 b            72  
                                           MaxBackward0         0.00%      84.000us         0.05%       1.259ms      62.950us       0.000us         0.00%     163.000us       8.150us           0 b           0 b      31.72 Mb           0 b            20  
               aten::value_selecting_reduction_backward         0.00%     130.000us         0.04%       1.175ms      58.750us       0.000us         0.00%     163.000us       8.150us           0 b           0 b      31.72 Mb           0 b            20  
                                           aten::__or__         0.00%      38.000us         0.02%     658.000us      32.900us       0.000us         0.00%     144.000us       7.200us           0 b           0 b      30.80 Mb           0 b            20  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     144.000us         0.03%     144.000us       7.200us           0 b           0 b           0 b           0 b            20  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     139.000us         0.03%     139.000us       1.782us           0 b           0 b           0 b           0 b            78  
                                           aten::linear         0.00%      58.000us         0.59%      16.212ms       1.621ms       0.000us         0.00%     136.000us      13.600us           0 b           0 b       5.00 Kb           0 b            10  
                                            aten::addmm         0.33%       8.966ms         0.58%      16.055ms       1.605ms     136.000us         0.03%     136.000us      13.600us           0 b           0 b       5.00 Kb       5.00 Kb            10  
                     Optimizer.zero_grad#Adam.zero_grad         0.05%       1.483ms         0.09%       2.543ms     254.300us       0.000us         0.00%     123.000us      12.300us         -40 b        -184 b           0 b           0 b            10  
enumerate(DataLoader)#_SingleProcessDataLoaderIter._...         0.24%       6.681ms        73.93%        2.035s     185.032ms       0.000us         0.00%     114.000us      10.364us         -44 b    -468.97 Kb     275.00 Kb           0 b            11  
                                            aten::stack         0.01%     301.000us        73.63%        2.027s      92.148ms       0.000us         0.00%     114.000us       5.182us           0 b           0 b     275.00 Kb           0 b            22  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     109.000us         0.02%     109.000us       5.450us           0 b           0 b           0 b           0 b            20  
                                          AddmmBackward         0.00%     134.000us         0.11%       2.895ms     289.500us       0.000us         0.00%     109.000us      10.900us           0 b           0 b      90.00 Kb           0 b            10  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.753s
Self CUDA time total: 440.133ms

