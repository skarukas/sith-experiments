Training using cuda
Loading training data
Loading validation data
Model Architecture:
SingleLPClassifier(
  (activation): ReLU()
  (dropout): Dropout(p=0.2, inplace=False)
  (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
  (conv_layers): ModuleList(
    (0): Conv2d(1, 32, kernel_size=(7, 7), stride=(1, 1))
    (1): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1))
  )
  (to_out): Linear(in_features=128, out_features=10, bias=True)
  (logpolar): InterpolatedLogPolarTransform(
    ntau=20, tau_range=1:30, ntheta=12, stride=1
    (filterbank): ShiftedConv2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
    )
  )
)
Total parameters: 128010
Profiling model...
Operations sorted by CUDA time:
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               CudnnConvolutionBackward         0.01%     181.000us         1.19%      33.619ms       1.121ms       0.000us         0.00%     242.679ms       8.089ms           0 b           0 b       3.77 Gb           0 b            30  
                       aten::cudnn_convolution_backward         0.02%     464.000us         1.18%      33.438ms       1.115ms       0.000us         0.00%     242.679ms       8.089ms           0 b           0 b       3.77 Gb           0 b            30  
                 aten::cudnn_convolution_backward_input         0.55%      15.660ms         0.68%      19.163ms     958.150us     126.171ms        30.37%     126.171ms       6.309ms           0 b           0 b       3.77 Gb      -1.20 Gb            20  
                aten::cudnn_convolution_backward_weight         0.39%      11.085ms         0.49%      13.811ms     460.367us     116.508ms        28.05%     116.508ms       3.884ms           0 b           0 b       4.83 Mb     -19.69 Gb            30  
void cudnn::detail::dgrad_engine<float, 512, 6, 5, 3...         0.00%       0.000us         0.00%       0.000us       0.000us      92.641ms        22.30%      92.641ms       9.264ms           0 b           0 b           0 b           0 b            10  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us      74.541ms        17.95%      74.541ms       7.454ms           0 b           0 b           0 b           0 b            10  
                                           aten::conv2d         0.01%     154.000us         8.52%     240.988ms       6.025ms       0.000us         0.00%      45.972ms       1.149ms           0 b           0 b       5.98 Gb           0 b            40  
                                      aten::convolution         0.01%     174.000us         8.51%     240.834ms       6.021ms       0.000us         0.00%      45.972ms       1.149ms           0 b           0 b       5.98 Gb           0 b            40  
                                     aten::_convolution         0.02%     513.000us         8.51%     240.660ms       6.016ms       0.000us         0.00%      45.972ms       1.149ms           0 b           0 b       5.98 Gb           0 b            40  
                                aten::cudnn_convolution         8.18%     231.493ms         8.44%     238.666ms       7.956ms      35.767ms         8.61%      35.767ms       1.192ms           0 b           0 b       5.92 Gb      -4.79 Gb            30  
                              aten::adaptive_max_pool2d         0.01%     295.000us         0.01%     400.000us      40.000us      29.477ms         7.10%      29.477ms       2.948ms           0 b           0 b      91.88 Mb      91.88 Mb            10  
void at::native::(anonymous namespace)::adaptivemaxp...         0.00%       0.000us         0.00%       0.000us       0.000us      29.477ms         7.10%      29.477ms       2.948ms           0 b           0 b           0 b           0 b            10  
void cutlass::Kernel<cutlass_tensorop_s1688dgrad_pre...         0.00%       0.000us         0.00%       0.000us       0.000us      24.506ms         5.90%      24.506ms       2.451ms           0 b           0 b           0 b           0 b            10  
                                        aten::clamp_min         0.02%     597.000us         0.13%       3.728ms      62.133us       9.265ms         2.23%      18.530ms     308.833us           0 b           0 b      11.84 Gb           0 b            60  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      17.685ms         4.26%      17.685ms     353.700us           0 b           0 b           0 b           0 b            50  
                                              aten::cat         0.01%     234.000us        71.78%        2.030s      39.044ms       0.000us         0.00%      16.929ms     325.558us           0 b           0 b       3.86 Gb           0 b            52  
                                             aten::_cat         0.03%     720.000us        71.77%        2.030s      39.040ms      16.929ms         4.08%      16.929ms     325.558us           0 b           0 b       3.86 Gb           0 b            52  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      16.824ms         4.05%      16.824ms     560.800us           0 b           0 b           0 b           0 b            30  
void nchwToNhwcKernel<float, float, float, true, fal...         0.00%       0.000us         0.00%       0.000us       0.000us      15.564ms         3.75%      15.564ms     259.400us           0 b           0 b           0 b           0 b            60  
                                          ReluBackward0         0.00%     126.000us         0.02%     700.000us      23.333us       0.000us         0.00%      14.092ms     469.733us           0 b           0 b       5.20 Gb    -735.00 Mb            30  
                               aten::threshold_backward         0.01%     371.000us         0.02%     574.000us      19.133us      14.092ms         3.39%      14.092ms     469.733us           0 b           0 b       5.92 Gb       5.92 Gb            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      14.092ms         3.39%      14.092ms     469.733us           0 b           0 b           0 b           0 b            30  
void fft2d_r2c_16x16<float>(float2*, float const*, i...         0.00%       0.000us         0.00%       0.000us       0.000us      13.727ms         3.30%      13.727ms     343.175us           0 b           0 b           0 b           0 b            40  
                                                batch_1         0.02%     705.000us         0.10%       2.777ms       2.777ms       0.000us         0.00%      12.792ms      12.792ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_2         0.02%     590.000us         0.09%       2.556ms       2.556ms       0.000us         0.00%      12.778ms      12.778ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_0         0.07%       1.973ms        11.13%     314.831ms     314.831ms       0.000us         0.00%      12.770ms      12.770ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                  ampere_cgemm_64x32_tn         0.00%       0.000us         0.00%       0.000us       0.000us      12.762ms         3.07%      12.762ms       1.276ms           0 b           0 b           0 b           0 b            10  
                                          aten::dropout         0.01%     145.000us         0.13%       3.689ms     122.967us       0.000us         0.00%      11.357ms     378.567us           0 b           0 b       7.40 Gb           0 b            30  
                                   aten::_fused_dropout         0.02%     666.000us         0.13%       3.544ms     118.133us      11.357ms         2.73%      11.357ms     378.567us           0 b           0 b       7.40 Gb           0 b            30  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us      11.357ms         2.73%      11.357ms     378.567us           0 b           0 b           0 b           0 b            30  
                                                batch_3         0.02%     593.000us         0.09%       2.533ms       2.533ms       0.000us         0.00%      11.043ms      11.043ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_7         0.02%     595.000us         0.09%       2.527ms       2.527ms       0.000us         0.00%      11.031ms      11.031ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_4         0.02%     586.000us         0.09%       2.519ms       2.519ms       0.000us         0.00%      11.025ms      11.025ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_5         0.02%     578.000us         0.09%       2.476ms       2.476ms       0.000us         0.00%      11.019ms      11.019ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_6         0.02%     594.000us         0.09%       2.538ms       2.538ms       0.000us         0.00%      11.019ms      11.019ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_8         0.02%     666.000us         0.09%       2.542ms       2.542ms       0.000us         0.00%      11.015ms      11.015ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                                batch_9         0.02%     580.000us         0.09%       2.448ms       2.448ms       0.000us         0.00%      11.003ms      11.003ms          -4 b         -20 b       1.42 Gb    -998.14 Mb             1  
                                   FusedDropoutBackward         0.00%     126.000us         0.03%     914.000us      30.467us       0.000us         0.00%      10.297ms     343.233us           0 b           0 b       5.92 Gb           0 b            30  
                                    aten::_masked_scale         0.01%     307.000us         0.03%     788.000us      26.267us      10.297ms         2.48%      10.297ms     343.233us           0 b           0 b       5.92 Gb           0 b            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      10.297ms         2.48%      10.297ms     343.233us           0 b           0 b           0 b           0 b            30  
                                             aten::add_         0.04%       1.187ms         0.07%       1.930ms      18.922us      10.099ms         2.43%      10.099ms      99.010us           0 b           0 b           0 b           0 b           102  
                                  ampere_cgemm_64x64_tn         0.00%       0.000us         0.00%       0.000us       0.000us      10.038ms         2.42%      10.038ms       1.004ms           0 b           0 b           0 b           0 b            10  
                              AdaptiveMaxPool2DBackward         0.00%      60.000us         0.01%     395.000us      39.500us       0.000us         0.00%       9.289ms     928.900us           0 b           0 b       2.87 Gb           0 b            10  
                     aten::adaptive_max_pool2d_backward         0.00%     122.000us         0.01%     335.000us      33.500us       6.867ms         1.65%       9.289ms     928.900us           0 b           0 b       2.87 Gb       2.87 Gb            10  
                                             aten::relu         0.01%     262.000us         0.08%       2.264ms      75.467us       0.000us         0.00%       9.265ms     308.833us           0 b           0 b       5.92 Gb           0 b            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       9.265ms         2.23%       9.265ms     308.833us           0 b           0 b           0 b           0 b            30  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us       9.049ms         2.18%       9.049ms     904.900us           0 b           0 b           0 b           0 b            10  
                                          SliceBackward         0.00%      47.000us         0.04%       1.143ms      57.150us       0.000us         0.00%       8.775ms     438.750us           0 b           0 b       3.05 Gb           0 b            20  
                                   aten::slice_backward         0.01%     161.000us         0.04%       1.096ms      54.800us       0.000us         0.00%       8.775ms     438.750us           0 b           0 b       3.05 Gb           0 b            20  
void cudnn::cnn::wgrad_alg0_engine<float, 128, 5, 5,...         0.00%       0.000us         0.00%       0.000us       0.000us       7.892ms         1.90%       7.892ms     789.200us           0 b           0 b           0 b           0 b            10  
                                              aten::add         0.01%     238.000us         0.01%     352.000us      17.600us       7.751ms         1.87%       7.751ms     387.550us           0 b           0 b       3.05 Gb       3.05 Gb            20  
                                            aten::copy_         0.03%     841.000us         0.06%       1.642ms      16.755us       6.906ms         1.66%       6.906ms      70.469us           0 b           0 b           0 b           0 b            98  
void at::native::(anonymous namespace)::atomicadapti...         0.00%       0.000us         0.00%       0.000us       0.000us       6.867ms         1.65%       6.867ms     686.700us           0 b           0 b           0 b           0 b            10  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us       6.607ms         1.59%       6.607ms     110.117us           0 b           0 b           0 b           0 b            60  
                                              aten::sum         0.03%     860.000us         0.05%       1.517ms      37.925us       6.165ms         1.48%       6.165ms     154.125us           0 b           0 b      20.00 Kb       1.50 Kb            40  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       6.046ms         1.46%       6.046ms     201.533us           0 b           0 b           0 b           0 b            30  
void fft2d_c2r_16x16<float, false>(float*, float2*, ...         0.00%       0.000us         0.00%       0.000us       0.000us       5.634ms         1.36%       5.634ms     281.700us           0 b           0 b           0 b           0 b            20  
                                            aten::fill_         0.03%     821.000us         0.07%       1.922ms      11.864us       5.166ms         1.24%       5.166ms      31.889us           0 b           0 b           0 b           0 b           162  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.166ms         1.24%       5.166ms      31.889us           0 b           0 b           0 b           0 b           162  
                                            aten::zero_         0.02%     580.000us         0.08%       2.155ms      11.776us       0.000us         0.00%       5.137ms      28.071us           0 b           0 b           0 b           0 b           183  
void implicit_convolve_sgemm<float, float, 1024, 5, ...         0.00%       0.000us         0.00%       0.000us       0.000us       3.792ms         0.91%       3.792ms     379.200us           0 b           0 b           0 b           0 b            10  
void flip_filter<float, float>(float*, float const*,...         0.00%       0.000us         0.00%       0.000us       0.000us       3.563ms         0.86%       3.563ms     178.150us           0 b           0 b           0 b           0 b            20  
void nhwcToNchwKernel<float, float, float, true, fal...         0.00%       0.000us         0.00%       0.000us       0.000us       3.264ms         0.79%       3.264ms     163.200us           0 b           0 b           0 b           0 b            20  
                                            aten::zeros         0.01%     411.000us         0.07%       2.052ms      20.317us       0.000us         0.00%       2.599ms      25.733us         164 b           0 b       3.08 Gb           0 b           101  
void cudnn::ops::scalePackedTensor_kernel<float, flo...         0.00%       0.000us         0.00%       0.000us       0.000us       1.386ms         0.33%       1.386ms     138.600us           0 b           0 b           0 b           0 b            10  
                                               aten::lt         0.02%     537.000us         0.05%       1.529ms      38.225us     255.000us         0.06%     510.000us      12.750us           0 b           0 b      61.60 Mb           0 b            40  
                                               aten::ge         0.02%     442.000us         0.05%       1.290ms      32.250us     251.000us         0.06%     502.000us      12.550us           0 b           0 b      61.60 Mb           0 b            40  
                                        aten::remainder         0.01%     401.000us         0.03%     908.000us      45.400us     338.000us         0.08%     338.000us      16.900us           0 b           0 b      61.60 Mb           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     338.000us         0.08%     338.000us      16.900us           0 b           0 b           0 b           0 b            20  
                                               aten::to         0.01%     224.000us         0.04%       1.210ms      15.125us       0.000us         0.00%     313.000us       3.913us           0 b           0 b     246.40 Mb           0 b            80  
                                           aten::gather         0.01%     350.000us         0.03%     924.000us      46.200us     287.000us         0.07%     287.000us      14.350us           0 b           0 b     123.19 Mb           0 b            20  
void at::native::_scatter_gather_elementwise_kernel<...         0.00%       0.000us         0.00%       0.000us       0.000us     287.000us         0.07%     287.000us      14.350us           0 b           0 b           0 b           0 b            20  
                                          aten::reshape         0.02%     472.000us         0.06%       1.803ms       9.489us       0.000us         0.00%     276.000us       1.453us           0 b           0 b      88.05 Mb           0 b           190  
                                            aten::clone         0.00%     103.000us         0.02%     668.000us      33.400us       0.000us         0.00%     276.000us      13.800us           0 b           0 b      88.05 Mb           0 b            20  
                                       aten::bitwise_or         0.04%       1.109ms         0.10%       2.698ms      67.450us     137.000us         0.03%     274.000us       6.850us           0 b           0 b      61.60 Mb           0 b            40  
                                              aten::max         0.02%     609.000us         0.04%       1.238ms      61.900us     273.000us         0.07%     273.000us      13.650us           0 b           0 b       3.40 Mb           0 b            20  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     273.000us         0.07%     273.000us      13.650us           0 b           0 b           0 b           0 b            20  
                            aten::thnn_conv_depthwise2d         0.00%      49.000us         0.01%     378.000us      37.800us       0.000us         0.00%     271.000us      27.100us           0 b           0 b      57.42 Mb           0 b            10  
                    aten::thnn_conv_depthwise2d_forward         0.01%     233.000us         0.01%     329.000us      32.900us     271.000us         0.07%     271.000us      27.100us           0 b           0 b      57.42 Mb      57.42 Mb            10  
void spatialDepthwiseConvolutionUpdateOutput<float, ...         0.00%       0.000us         0.00%       0.000us       0.000us     271.000us         0.07%     271.000us      27.100us           0 b           0 b           0 b           0 b            10  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     255.000us         0.06%     255.000us      12.750us           0 b           0 b           0 b           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     251.000us         0.06%     251.000us      12.550us           0 b           0 b           0 b           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     209.000us         0.05%     209.000us      10.450us           0 b           0 b           0 b           0 b            20  
                                            aten::where         0.00%      61.000us         0.02%     559.000us      27.950us       0.000us         0.00%     196.000us       9.800us           0 b           0 b     123.19 Mb           0 b            20  
                                         aten::_s_where         0.01%     255.000us         0.02%     498.000us      24.900us     196.000us         0.05%     196.000us       9.800us           0 b           0 b     123.19 Mb           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     196.000us         0.05%     196.000us       9.800us           0 b           0 b           0 b           0 b            20  
                        torch::autograd::AccumulateGrad         0.01%     308.000us         0.06%       1.675ms      20.938us       0.000us         0.00%     182.000us       2.275us           0 b           0 b      -1.09 Mb      -1.58 Mb            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     165.000us         0.04%     165.000us       2.292us           0 b           0 b           0 b           0 b            72  
                                           MaxBackward0         0.00%      82.000us         0.05%       1.310ms      65.500us       0.000us         0.00%     150.000us       7.500us           0 b           0 b      31.72 Mb           0 b            20  
               aten::value_selecting_reduction_backward         0.01%     148.000us         0.04%       1.228ms      61.400us       0.000us         0.00%     150.000us       7.500us           0 b           0 b      31.72 Mb           0 b            20  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     143.000us         0.03%     143.000us       1.833us           0 b           0 b           0 b           0 b            78  
                                           aten::__or__         0.00%      42.000us         0.05%       1.451ms      72.550us       0.000us         0.00%     137.000us       6.850us           0 b           0 b      30.80 Mb           0 b            20  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     137.000us         0.03%     137.000us       6.850us           0 b           0 b           0 b           0 b            20  
                                           aten::linear         0.00%      80.000us         2.29%      64.699ms       6.470ms       0.000us         0.00%     126.000us      12.600us           0 b           0 b       5.00 Kb           0 b            10  
                                            aten::addmm         2.15%      60.760ms         2.28%      64.510ms       6.451ms     126.000us         0.03%     126.000us      12.600us           0 b           0 b       5.00 Kb       5.00 Kb            10  
                     Optimizer.zero_grad#Adam.zero_grad         0.02%     474.000us         0.05%       1.427ms     142.700us       0.000us         0.00%     116.000us      11.600us         -40 b        -152 b           0 b           0 b            10  
enumerate(DataLoader)#_SingleProcessDataLoaderIter._...         0.19%       5.405ms        71.99%        2.036s     185.100ms       0.000us         0.00%     105.000us       9.545us         -44 b    -468.97 Kb     275.00 Kb           0 b            11  
                                            aten::stack         0.01%     302.000us        71.75%        2.029s      92.240ms       0.000us         0.00%     105.000us       4.773us           0 b           0 b     275.00 Kb           0 b            22  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     104.000us         0.03%     104.000us       5.200us           0 b           0 b           0 b           0 b            20  
                                          AddmmBackward         0.01%     150.000us         0.11%       3.208ms     320.800us       0.000us         0.00%     102.000us      10.200us           0 b           0 b      90.00 Kb           0 b            10  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.828s
Self CUDA time total: 415.383ms

