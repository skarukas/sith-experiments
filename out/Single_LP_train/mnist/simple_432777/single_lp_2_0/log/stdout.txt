Training using cuda
Loading training data
Loading validation data
Model Architecture:
SingleLPClassifier(
  (activation): ReLU()
  (dropout): Dropout(p=0.2, inplace=False)
  (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
  (conv_layers): ModuleList(
    (0): Conv2d(1, 32, kernel_size=(7, 7), stride=(1, 1))
    (1): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1))
  )
  (to_out): Linear(in_features=128, out_features=10, bias=True)
  (logpolar): InterpolatedLogPolarTransform(
    ntau=20, tau_range=1:30, ntheta=12, stride=1
    (filterbank): ShiftedConv2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
    )
  )
)
Total parameters: 128010
Operations sorted by CUDA time:
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               CudnnConvolutionBackward         0.00%     186.000us         2.52%     103.989ms       3.466ms       0.000us         0.00%     927.020ms      30.901ms           0 b           0 b      15.08 Gb           0 b            30  
                       aten::cudnn_convolution_backward         0.01%     303.000us         2.52%     103.803ms       3.460ms       0.000us         0.00%     927.020ms      30.901ms           0 b           0 b      15.08 Gb           0 b            30  
                 aten::cudnn_convolution_backward_input         0.45%      18.485ms         0.89%      36.603ms       1.830ms     489.390ms        30.79%     489.390ms      24.470ms           0 b           0 b      15.07 Gb      -4.79 Gb            20  
                aten::cudnn_convolution_backward_weight         1.22%      50.185ms         1.62%      66.897ms       2.230ms     437.630ms        27.54%     437.630ms      14.588ms           0 b           0 b       4.83 Mb     -78.74 Gb            30  
void cudnn::detail::dgrad_engine<float, 512, 6, 5, 3...         0.00%       0.000us         0.00%       0.000us       0.000us     360.765ms        22.70%     360.765ms      36.077ms           0 b           0 b           0 b           0 b            10  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us     287.748ms        18.11%     287.748ms      28.775ms           0 b           0 b           0 b           0 b            10  
                                           aten::conv2d         0.00%     162.000us         6.35%     262.147ms       6.554ms       0.000us         0.00%     170.784ms       4.270ms           0 b           0 b      23.92 Gb           0 b            40  
                                      aten::convolution         0.00%     164.000us         6.35%     261.985ms       6.550ms       0.000us         0.00%     170.784ms       4.270ms           0 b           0 b      23.92 Gb           0 b            40  
                                     aten::_convolution         0.01%     494.000us         6.35%     261.821ms       6.546ms       0.000us         0.00%     170.784ms       4.270ms           0 b           0 b      23.92 Gb           0 b            40  
                                aten::cudnn_convolution         5.86%     241.587ms         6.26%     258.124ms       8.604ms     131.693ms         8.29%     131.693ms       4.390ms           0 b           0 b      23.70 Gb     -19.14 Gb            30  
                              aten::adaptive_max_pool2d         0.01%     228.000us         0.01%     320.000us      32.000us     111.797ms         7.03%     111.797ms      11.180ms           0 b           0 b     367.50 Mb     367.50 Mb            10  
void at::native::(anonymous namespace)::adaptivemaxp...         0.00%       0.000us         0.00%       0.000us       0.000us     111.797ms         7.03%     111.797ms      11.180ms           0 b           0 b           0 b           0 b            10  
void cutlass::Kernel<cutlass_tensorop_s1688dgrad_pre...         0.00%       0.000us         0.00%       0.000us       0.000us      92.115ms         5.80%      92.115ms       9.211ms           0 b           0 b           0 b           0 b            10  
                                        aten::clamp_min         0.01%     521.000us         0.17%       7.135ms     118.917us      36.796ms         2.32%      73.592ms       1.227ms           0 b           0 b      47.37 Gb           0 b            60  
                                              aten::cat         0.01%     256.000us        48.99%        2.021s      38.863ms       0.000us         0.00%      71.528ms       1.376ms           0 b           0 b      15.41 Gb           0 b            52  
                                             aten::_cat         0.04%       1.578ms        48.98%        2.021s      38.858ms      71.528ms         4.50%      71.528ms       1.376ms           0 b           0 b      15.41 Gb           0 b            52  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      71.283ms         4.49%      71.283ms       2.376ms           0 b           0 b           0 b           0 b            30  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      69.043ms         4.34%      69.043ms       1.381ms           0 b           0 b           0 b           0 b            50  
void nchwToNhwcKernel<float, float, float, true, fal...         0.00%       0.000us         0.00%       0.000us       0.000us      62.256ms         3.92%      62.256ms       1.038ms           0 b           0 b           0 b           0 b            60  
                                          ReluBackward0         0.00%     119.000us         0.06%       2.422ms      80.733us       0.000us         0.00%      56.072ms       1.869ms           0 b           0 b      22.54 Gb      -1.15 Gb            30  
                               aten::threshold_backward         0.01%     352.000us         0.06%       2.303ms      76.767us      56.072ms         3.53%      56.072ms       1.869ms           0 b           0 b      23.69 Gb      23.69 Gb            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      56.072ms         3.53%      56.072ms       1.869ms           0 b           0 b           0 b           0 b            30  
void fft2d_r2c_16x16<float>(float2*, float const*, i...         0.00%       0.000us         0.00%       0.000us       0.000us      50.937ms         3.20%      50.937ms       1.273ms           0 b           0 b           0 b           0 b            40  
                                                batch_0         0.04%       1.626ms         8.65%     356.703ms     356.703ms       0.000us         0.00%      50.829ms      50.829ms          -4 b         -20 b       5.68 Gb      -3.90 Gb             1  
                                  ampere_cgemm_64x32_tn         0.00%       0.000us         0.00%       0.000us       0.000us      48.024ms         3.02%      48.024ms       4.802ms           0 b           0 b           0 b           0 b            10  
                                          aten::dropout         0.00%     141.000us         0.12%       4.798ms     159.933us       0.000us         0.00%      44.918ms       1.497ms           0 b           0 b      29.61 Gb           0 b            30  
                                   aten::_fused_dropout         0.02%     647.000us         0.11%       4.657ms     155.233us      44.918ms         2.83%      44.918ms       1.497ms           0 b           0 b      29.61 Gb           0 b            30  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us      44.918ms         2.83%      44.918ms       1.497ms           0 b           0 b           0 b           0 b            30  
                                                batch_1         0.02%     727.000us         0.07%       3.013ms       3.013ms       0.000us         0.00%      43.799ms      43.799ms          -4 b          -4 b       5.68 Gb      -3.90 Gb             1  
                                                batch_8         0.02%     660.000us         0.06%       2.526ms       2.526ms       0.000us         0.00%      43.741ms      43.741ms          -4 b         -20 b       5.68 Gb      -3.90 Gb             1  
                                                batch_6         0.01%     605.000us         0.07%       2.821ms       2.821ms       0.000us         0.00%      43.734ms      43.734ms          -4 b          -4 b       5.68 Gb      -3.90 Gb             1  
                                                batch_9         0.01%     610.000us         1.47%      60.837ms      60.837ms       0.000us         0.00%      43.732ms      43.732ms          -4 b          -4 b       5.68 Gb      -3.90 Gb             1  
                                                batch_3         0.01%     615.000us         0.06%       2.544ms       2.544ms       0.000us         0.00%      43.715ms      43.715ms          -4 b          -4 b       5.68 Gb      -3.90 Gb             1  
                                                batch_4         0.01%     615.000us         0.06%       2.590ms       2.590ms       0.000us         0.00%      43.695ms      43.695ms          -4 b         -20 b       5.68 Gb      -3.90 Gb             1  
                                                batch_7         0.01%     578.000us         0.06%       2.454ms       2.454ms       0.000us         0.00%      43.650ms      43.650ms          -4 b         -20 b       5.68 Gb      -3.90 Gb             1  
                                                batch_2         0.01%     617.000us         0.07%       2.687ms       2.687ms       0.000us         0.00%      43.592ms      43.592ms          -4 b         -20 b       5.68 Gb      -3.90 Gb             1  
                                                batch_5         0.01%     606.000us         0.06%       2.607ms       2.607ms       0.000us         0.00%      43.534ms      43.534ms          -4 b         -20 b       5.68 Gb      -3.90 Gb             1  
                                   FusedDropoutBackward         0.00%     116.000us         0.06%       2.629ms      87.633us       0.000us         0.00%      41.213ms       1.374ms           0 b           0 b      23.69 Gb           0 b            30  
                                    aten::_masked_scale         0.01%     282.000us         0.06%       2.513ms      83.767us      41.213ms         2.59%      41.213ms       1.374ms           0 b           0 b      23.69 Gb           0 b            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      41.213ms         2.59%      41.213ms       1.374ms           0 b           0 b           0 b           0 b            30  
                                             aten::add_         0.04%       1.762ms         0.20%       8.213ms      80.520us      38.201ms         2.40%      38.201ms     374.520us           0 b           0 b           0 b           0 b           102  
                                  ampere_cgemm_64x64_tn         0.00%       0.000us         0.00%       0.000us       0.000us      37.670ms         2.37%      37.670ms       3.767ms           0 b           0 b           0 b           0 b            10  
                                             aten::relu         0.01%     379.000us         0.10%       4.085ms     136.167us       0.000us         0.00%      36.796ms       1.227ms           0 b           0 b      23.69 Gb           0 b            30  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      36.796ms         2.32%      36.796ms       1.227ms           0 b           0 b           0 b           0 b            30  
                              AdaptiveMaxPool2DBackward         0.00%      50.000us         0.01%     367.000us      36.700us       0.000us         0.00%      35.191ms       3.519ms           0 b           0 b      11.48 Gb           0 b            10  
                     aten::adaptive_max_pool2d_backward         0.00%     120.000us         0.01%     317.000us      31.700us      26.014ms         1.64%      35.191ms       3.519ms           0 b           0 b      11.48 Gb      11.48 Gb            10  
                                          SliceBackward         0.00%      48.000us         0.06%       2.340ms     117.000us       0.000us         0.00%      34.227ms       1.711ms           0 b           0 b      12.20 Gb           0 b            20  
                                   aten::slice_backward         0.00%     125.000us         0.06%       2.292ms     114.600us       0.000us         0.00%      34.227ms       1.711ms           0 b           0 b      12.20 Gb           0 b            20  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us      32.268ms         2.03%      32.268ms       3.227ms           0 b           0 b           0 b           0 b            10  
                                              aten::add         0.01%     247.000us         0.08%       3.481ms     174.050us      30.999ms         1.95%      30.999ms       1.550ms           0 b           0 b      12.20 Gb      12.20 Gb            20  
                                            aten::copy_         0.02%     825.000us         0.05%       1.875ms      19.133us      26.623ms         1.68%      26.623ms     271.663us           0 b           0 b           0 b           0 b            98  
void at::native::(anonymous namespace)::atomicadapti...         0.00%       0.000us         0.00%       0.000us       0.000us      26.014ms         1.64%      26.014ms       2.601ms           0 b           0 b           0 b           0 b            10  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      25.518ms         1.61%      25.518ms     425.300us           0 b           0 b           0 b           0 b            60  
void fft2d_c2r_16x16<float, false>(float*, float2*, ...         0.00%       0.000us         0.00%       0.000us       0.000us      20.297ms         1.28%      20.297ms       1.015ms           0 b           0 b           0 b           0 b            20  
void cudnn::cnn::wgrad_alg0_engine<float, 128, 5, 5,...         0.00%       0.000us         0.00%       0.000us       0.000us      20.153ms         1.27%      20.153ms       2.015ms           0 b           0 b           0 b           0 b            10  
                                              aten::sum         0.02%     831.000us         0.37%      15.143ms     378.575us      19.366ms         1.22%      19.366ms     484.150us           0 b           0 b      20.00 Kb       2.00 Kb            40  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      19.270ms         1.21%      19.270ms     642.333us           0 b           0 b           0 b           0 b            30  
                                            aten::fill_         0.02%     821.000us         1.09%      45.168ms     278.815us      19.125ms         1.20%      19.125ms     118.056us           0 b           0 b           0 b           0 b           162  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      19.125ms         1.20%      19.125ms     118.056us           0 b           0 b           0 b           0 b           162  
                                            aten::zero_         0.02%     670.000us         1.10%      45.477ms     248.508us       0.000us         0.00%      19.097ms     104.355us           0 b           0 b           0 b           0 b           183  
void implicit_convolve_sgemm<float, float, 1024, 5, ...         0.00%       0.000us         0.00%       0.000us       0.000us      14.095ms         0.89%      14.095ms       1.409ms           0 b           0 b           0 b           0 b            10  
void flip_filter<float, float>(float*, float const*,...         0.00%       0.000us         0.00%       0.000us       0.000us      13.539ms         0.85%      13.539ms     676.950us           0 b           0 b           0 b           0 b            20  
void nhwcToNchwKernel<float, float, float, true, fal...         0.00%       0.000us         0.00%       0.000us       0.000us      13.028ms         0.82%      13.028ms     651.400us           0 b           0 b           0 b           0 b            20  
                                            aten::zeros         0.01%     395.000us         1.10%      45.218ms     447.703us       0.000us         0.00%       9.810ms      97.129us         164 b           0 b      12.33 Gb           0 b           101  
void cudnn::ops::scalePackedTensor_kernel<float, flo...         0.00%       0.000us         0.00%       0.000us       0.000us       5.363ms         0.34%       5.363ms     536.300us           0 b           0 b           0 b           0 b            10  
                                               aten::lt         0.01%     534.000us         0.10%       4.071ms     101.775us     824.000us         0.05%       1.648ms      41.200us           0 b           0 b     246.39 Mb           0 b            40  
                                               aten::ge         0.01%     455.000us         0.21%       8.601ms     215.025us     823.000us         0.05%       1.646ms      41.150us           0 b           0 b     246.39 Mb           0 b            40  
                                           aten::gather         0.01%     377.000us         0.02%       1.009ms      50.450us       1.629ms         0.10%       1.629ms      81.450us           0 b           0 b     492.77 Mb           0 b            20  
void at::native::_scatter_gather_elementwise_kernel<...         0.00%       0.000us         0.00%       0.000us       0.000us       1.629ms         0.10%       1.629ms      81.450us           0 b           0 b           0 b           0 b            20  
                                        aten::remainder         0.01%     417.000us         0.02%       1.002ms      50.100us       1.158ms         0.07%       1.158ms      57.900us           0 b           0 b     246.39 Mb           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us       1.158ms         0.07%       1.158ms      57.900us           0 b           0 b           0 b           0 b            20  
                                               aten::to         0.01%     226.000us         0.04%       1.786ms      22.325us       0.000us         0.00%       1.119ms      13.988us           0 b           0 b    1000.01 Mb           0 b            80  
                            aten::thnn_conv_depthwise2d         0.00%      42.000us         0.01%     357.000us      35.700us       0.000us         0.00%       1.047ms     104.700us           0 b           0 b     229.69 Mb           0 b            10  
                    aten::thnn_conv_depthwise2d_forward         0.01%     222.000us         0.01%     315.000us      31.500us       1.047ms         0.07%       1.047ms     104.700us           0 b           0 b     229.69 Mb     229.69 Mb            10  
void spatialDepthwiseConvolutionUpdateOutput<float, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.047ms         0.07%       1.047ms     104.700us           0 b           0 b           0 b           0 b            10  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us       1.011ms         0.06%       1.011ms      50.550us           0 b           0 b           0 b           0 b            20  
                                            aten::where         0.00%      57.000us         0.01%     579.000us      28.950us       0.000us         0.00%     892.000us      44.600us           0 b           0 b     492.77 Mb           0 b            20  
                                         aten::_s_where         0.01%     264.000us         0.01%     522.000us      26.100us     892.000us         0.06%     892.000us      44.600us           0 b           0 b     492.77 Mb           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     892.000us         0.06%     892.000us      44.600us           0 b           0 b           0 b           0 b            20  
                                          aten::reshape         0.02%     747.000us         0.05%       2.268ms      11.937us       0.000us         0.00%     869.000us       4.574us           0 b           0 b     352.19 Mb           0 b           190  
                                            aten::clone         0.00%     101.000us         0.02%     880.000us      44.000us       0.000us         0.00%     869.000us      43.450us           0 b           0 b     352.19 Mb           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     824.000us         0.05%     824.000us      41.200us           0 b           0 b           0 b           0 b            20  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     823.000us         0.05%     823.000us      41.150us           0 b           0 b           0 b           0 b            20  
                                       aten::bitwise_or         0.01%     603.000us         0.27%      11.233ms     280.825us     403.000us         0.03%     806.000us      20.150us           0 b           0 b     246.39 Mb           0 b            40  
                                              aten::max         0.01%     487.000us         0.03%       1.261ms      63.050us     630.000us         0.04%     630.000us      31.500us           0 b           0 b      13.59 Mb           0 b            20  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     630.000us         0.04%     630.000us      31.500us           0 b           0 b           0 b           0 b            20  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     511.000us         0.03%     511.000us       6.551us           0 b           0 b           0 b           0 b            78  
                                           aten::__or__         0.00%      44.000us         0.14%       5.726ms     286.300us       0.000us         0.00%     403.000us      20.150us           0 b           0 b     123.19 Mb           0 b            20  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     403.000us         0.03%     403.000us      20.150us           0 b           0 b           0 b           0 b            20  
                                           ViewBackward         0.00%     107.000us         0.02%     669.000us      13.380us       0.000us         0.00%     266.000us       5.320us           0 b           0 b     122.50 Mb           0 b            50  
enumerate(DataLoader)#_SingleProcessDataLoaderIter._...         0.08%       3.431ms        49.04%        2.023s     183.902ms       0.000us         0.00%     245.000us      22.273us         -44 b    -468.94 Kb       1.06 Mb           0 b            11  
                                            aten::stack         0.02%     727.000us        48.94%        2.019s      91.766ms       0.000us         0.00%     245.000us      11.136us           0 b           0 b       1.06 Mb           0 b            22  
                                           MaxBackward0         0.00%      76.000us         0.03%       1.237ms      61.850us       0.000us         0.00%     229.000us      11.450us           0 b           0 b     126.88 Mb           0 b            20  
               aten::value_selecting_reduction_backward         0.00%     130.000us         0.03%       1.161ms      58.050us       0.000us         0.00%     229.000us      11.450us           0 b           0 b     126.88 Mb           0 b            20  
                        torch::autograd::AccumulateGrad         0.01%     284.000us         0.16%       6.440ms      80.500us       0.000us         0.00%     176.000us       2.200us           0 b           0 b    -708.00 Kb      -1.18 Mb            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     157.000us         0.01%     157.000us       2.181us           0 b           0 b           0 b           0 b            72  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     125.000us         0.01%     125.000us      11.364us           0 b           0 b           0 b           0 b            11  
                                           aten::linear         0.00%      60.000us         2.07%      85.435ms       8.543ms       0.000us         0.00%     121.000us      12.100us           0 b           0 b      15.00 Kb           0 b            10  
                                            aten::addmm         1.51%      62.293ms         2.07%      85.292ms       8.529ms     121.000us         0.01%     121.000us      12.100us           0 b           0 b      15.00 Kb      15.00 Kb            10  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     120.000us         0.01%     120.000us      10.909us           0 b           0 b           0 b           0 b            11  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.125s
Self CUDA time total: 1.589s

