Training using cuda
Loading training data
Loading validation data
Model Architecture:
LPResNet(
  (conv): LogPolarConv(
    (lpconv): _LogPolar_Core(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (conv): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), bias=False)
      (depth_pool): MaxPool2d(kernel_size=(18, 12), stride=(18, 12), padding=0, dilation=1, ceil_mode=False)
    )
    (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout): Dropout(p=0, inplace=False)
  )
  (activation): ReLU()
  (layer1): Sequential(
    (0): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (1): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (2): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (3): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (4): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (5): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (6): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
  )
  (layer2): Sequential(
    (0): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(8, 8))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (1): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (2): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (3): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (4): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (5): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (6): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
  )
  (layer3): Sequential(
    (0): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(8, 8))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (1): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (2): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (3): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (4): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (5): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
    (6): DeepLPBlock(
      (logpolar): InterpolatedLogPolarTransform(
        ntau=20, tau_range=1:30.00 (c=0.1960), ntheta=12, stride=1
        (filterbank): ShiftedConv2d(
          (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
        )
      )
      (spatial_trim): Trim2d(trim_size=(0, 0))
      (depth_pool): AdaptiveMaxPool2d(output_size=(1, 1))
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (activation): ReLU()
      (shortcut): Lambda()
    )
  )
  (to_logits): Linear(in_features=64, out_features=10, bias=True)
  (pool): AdaptiveMaxPool2d(output_size=(1, 1))
)
Total parameters: 660170
Profiling model...
Operations sorted by CUDA time:
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               CudnnConvolutionBackward         0.02%       1.413ms         2.04%     136.585ms     635.279us       0.000us         0.00%     871.610ms       4.054ms           0 b           0 b      22.23 Gb           0 b           215  
                       aten::cudnn_convolution_backward         0.04%       2.595ms         2.02%     135.172ms     628.707us       0.000us         0.00%     871.610ms       4.054ms           0 b           0 b      22.23 Gb           0 b           215  
                 aten::cudnn_convolution_backward_input         0.16%      10.679ms         0.64%      42.723ms     203.443us     522.685ms        20.58%     522.685ms       2.489ms           0 b           0 b      22.22 Gb      22.22 Gb           210  
void cudnn::detail::dgrad_engine<float, 512, 6, 5, 3...         0.00%       0.000us         0.00%       0.000us       0.000us     505.176ms        19.89%     505.176ms       2.406ms           0 b           0 b           0 b           0 b           210  
                                           aten::conv2d         0.02%       1.444ms         1.55%     104.080ms     320.246us       0.000us         0.00%     362.201ms       1.114ms           0 b           0 b      28.32 Gb           0 b           325  
                                      aten::convolution         0.02%       1.408ms         1.53%     102.636ms     315.803us       0.000us         0.00%     362.201ms       1.114ms           0 b           0 b      28.32 Gb           0 b           325  
                                     aten::_convolution         0.06%       3.862ms         1.51%     101.228ms     311.471us       0.000us         0.00%     362.201ms       1.114ms           0 b           0 b      28.32 Gb           0 b           325  
                aten::cudnn_convolution_backward_weight         0.26%      17.321ms         1.34%      89.854ms     417.926us     348.925ms        13.74%     348.925ms       1.623ms           0 b           0 b      12.49 Mb     -20.10 Gb           215  
                                aten::cudnn_convolution         0.66%      44.372ms         1.28%      86.016ms     400.074us     287.481ms        11.32%     287.481ms       1.337ms           0 b           0 b      17.96 Gb     -22.41 Gb           215  
                                                batch_0         0.27%      17.798ms         3.79%     253.965ms     253.965ms       0.000us         0.00%     216.635ms     216.635ms          -4 b         -20 b      24.64 Gb     -15.19 Gb             1  
                                                batch_2         0.22%      14.850ms         0.90%      59.923ms      59.923ms       0.000us         0.00%     198.051ms     198.051ms          -4 b         -20 b      24.63 Gb     -15.20 Gb             1  
                                                batch_4         0.22%      14.714ms         0.91%      60.927ms      60.927ms       0.000us         0.00%     198.008ms     198.008ms          -4 b         -20 b      24.63 Gb     -15.20 Gb             1  
                                                batch_3         0.26%      17.340ms         1.04%      69.433ms      69.433ms       0.000us         0.00%     197.995ms     197.995ms          -4 b         -20 b      24.63 Gb     -15.20 Gb             1  
                                                batch_1         0.23%      15.563ms         0.93%      62.034ms      62.034ms       0.000us         0.00%     197.917ms     197.917ms          -4 b         -20 b      24.63 Gb     -15.20 Gb             1  
                                            aten::copy_         0.26%      17.481ms         1.63%     109.429ms      57.594us     187.072ms         7.36%     187.072ms      98.459us           0 b           0 b           0 b           0 b          1900  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us     177.321ms         6.98%     177.321ms       2.364ms           0 b           0 b           0 b           0 b            75  
                                 CudnnBatchNormBackward         0.03%       1.896ms         0.40%      26.930ms     125.256us       0.000us         0.00%     166.929ms     776.414us           0 b           0 b       9.27 Gb           0 b           215  
                        aten::cudnn_batch_norm_backward         0.10%       6.733ms         0.37%      25.034ms     116.437us     166.929ms         6.57%     166.929ms     776.414us           0 b           0 b       9.27 Gb           0 b           215  
void cudnn::bn_bw_1C11_kernel_new<float, float, floa...         0.00%       0.000us         0.00%       0.000us       0.000us     163.365ms         6.43%     163.365ms       1.485ms           0 b           0 b           0 b           0 b           110  
void wgrad2d_grouped_direct_kernel<float, float, flo...         0.00%       0.000us         0.00%       0.000us       0.000us     136.792ms         5.38%     136.792ms      27.358ms           0 b           0 b           0 b           0 b             5  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     118.629ms         4.67%     118.629ms     120.436us           0 b           0 b           0 b           0 b           985  
                                          SliceBackward         0.03%       1.935ms         2.21%     148.150ms     235.159us       0.000us         0.00%     115.904ms     183.975us           0 b           0 b      39.34 Gb           0 b           630  
                                   aten::slice_backward         0.05%       3.675ms         2.18%     146.220ms     232.095us       0.000us         0.00%     115.904ms     183.975us           0 b           0 b      39.34 Gb           0 b           630  
                                       aten::batch_norm         0.01%     935.000us         0.33%      21.783ms     101.316us       0.000us         0.00%     114.607ms     533.056us           0 b           0 b       9.27 Gb           0 b           215  
                           aten::_batch_norm_impl_index         0.02%       1.132ms         0.31%      20.848ms      96.967us       0.000us         0.00%     114.607ms     533.056us           0 b           0 b       9.27 Gb           0 b           215  
                                 aten::cudnn_batch_norm         0.11%       7.402ms         0.29%      19.716ms      91.702us     114.607ms         4.51%     114.607ms     533.056us           0 b           0 b       9.27 Gb           0 b           215  
void cudnn::bn_fw_tr_1C11_kernel_NCHW<float, float, ...         0.00%       0.000us         0.00%       0.000us       0.000us     110.977ms         4.37%     110.977ms       1.057ms           0 b           0 b           0 b           0 b           105  
                                         GatherBackward         0.02%       1.085ms         0.63%      42.406ms     201.933us       0.000us         0.00%     109.112ms     519.581us           0 b           0 b      22.59 Gb           0 b           210  
                                  aten::gather_backward         0.02%       1.106ms         0.62%      41.321ms     196.767us       0.000us         0.00%     109.112ms     519.581us           0 b           0 b      22.59 Gb           0 b           210  
                                              aten::cat         0.02%       1.361ms         0.29%      19.637ms      86.507us       0.000us         0.00%     101.315ms     446.322us           0 b           0 b      22.35 Gb           0 b           227  
                                             aten::_cat         0.05%       3.141ms         0.27%      18.276ms      80.511us     101.315ms         3.99%     101.315ms     446.322us           0 b           0 b      22.35 Gb           0 b           227  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     101.290ms         3.99%     101.290ms     458.326us           0 b           0 b           0 b           0 b           221  
                                            aten::where         0.02%       1.207ms         0.93%      62.362ms     145.028us       0.000us         0.00%      98.682ms     229.493us           0 b           0 b      42.35 Gb      -3.05 Gb           430  
                                         aten::_s_where         0.09%       6.034ms         0.91%      61.155ms     142.221us      98.682ms         3.88%      98.682ms     229.493us           0 b           0 b      45.40 Gb           0 b           430  
void cudnn::cnn::wgrad_alg0_engine<float, 128, 5, 5,...         0.00%       0.000us         0.00%       0.000us       0.000us      94.722ms         3.73%      94.722ms       1.353ms           0 b           0 b           0 b           0 b            70  
                                     aten::scatter_add_         0.04%       2.835ms         0.27%      18.159ms      86.471us      91.428ms         3.60%      91.428ms     435.371us           0 b           0 b           0 b           0 b           210  
void at::native::_scatter_gather_elementwise_kernel<...         0.00%       0.000us         0.00%       0.000us       0.000us      91.428ms         3.60%      91.428ms     435.371us           0 b           0 b           0 b           0 b           210  
                              aten::adaptive_max_pool2d         0.05%       3.229ms         0.13%       8.593ms      78.118us      76.768ms         3.02%      76.790ms     698.091us           0 b           0 b     131.28 Mb     128.78 Mb           110  
                                         SWhereBackward         0.03%       1.934ms         0.99%      66.116ms     314.838us       0.000us         0.00%      76.786ms     365.648us           0 b           0 b      22.58 Gb     -19.54 Gb           210  
void at::native::(anonymous namespace)::adaptivemaxp...         0.00%       0.000us         0.00%       0.000us       0.000us      76.768ms         3.02%      76.768ms     697.891us           0 b           0 b           0 b           0 b           110  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      76.396ms         3.01%      76.396ms     161.514us           0 b           0 b           0 b           0 b           473  
                                            aten::fill_         0.22%      15.013ms         2.08%     139.146ms      63.076us      74.934ms         2.95%      74.934ms      33.968us           0 b           0 b           0 b           0 b          2206  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      74.934ms         2.95%      74.934ms      33.968us           0 b           0 b           0 b           0 b          2206  
                                            aten::zero_         0.15%      10.085ms         2.19%     146.671ms      69.777us       0.000us         0.00%      74.713ms      35.544us           0 b           0 b           0 b           0 b          2102  
                                               aten::lt         0.08%       5.272ms         0.27%      17.966ms      40.832us      37.324ms         1.47%      74.648ms     169.655us         -48 b           0 b      11.45 Gb           0 b           440  
                                               aten::ge         0.10%       6.503ms         0.29%      19.518ms      44.359us      37.270ms         1.47%      74.540ms     169.409us           0 b           0 b      11.41 Gb           0 b           440  
                                           aten::gather         0.08%       5.090ms         0.15%      10.374ms      47.155us      66.752ms         2.63%      66.752ms     303.418us           0 b           0 b      22.80 Gb           0 b           220  
void at::native::_scatter_gather_elementwise_kernel<...         0.00%       0.000us         0.00%       0.000us       0.000us      66.752ms         2.63%      66.752ms     303.418us           0 b           0 b           0 b           0 b           220  
void nchwToNhwcKernel<float, float, float, true, fal...         0.00%       0.000us         0.00%       0.000us       0.000us      62.189ms         2.45%      62.189ms     111.052us           0 b           0 b           0 b           0 b           560  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      59.099ms         2.33%      59.099ms     281.424us           0 b           0 b           0 b           0 b           210  
                                        aten::remainder         0.09%       5.945ms         0.17%      11.406ms      42.560us      52.670ms         2.07%      52.670ms     196.530us           0 b           0 b      11.40 Gb           0 b           268  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      52.567ms         2.07%      52.567ms     238.941us           0 b           0 b           0 b           0 b           220  
                                               aten::to         0.05%       3.486ms         0.71%      47.502ms      58.356us       0.000us         0.00%      51.457ms      63.215us           0 b           0 b      45.64 Gb           0 b           814  
                            ThnnConvDepthwise2DBackward         0.01%     730.000us         0.33%      22.058ms     210.076us       0.000us         0.00%      51.193ms     487.552us           0 b           0 b      11.29 Gb           0 b           105  
                   aten::thnn_conv_depthwise2d_backward         0.03%       2.030ms         0.32%      21.328ms     203.124us      51.193ms         2.02%      51.193ms     487.552us           0 b           0 b      11.29 Gb      11.29 Gb           105  
void spatialDepthwiseConvolutionUpdateGradInput<floa...         0.00%       0.000us         0.00%       0.000us       0.000us      51.193ms         2.02%      51.193ms     487.552us           0 b           0 b           0 b           0 b           105  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      50.309ms         1.98%      50.309ms     228.677us           0 b           0 b           0 b           0 b           220  
                                            aten::clone         0.06%       3.987ms         0.86%      57.302ms     131.729us       0.000us         0.00%      50.070ms     115.103us           0 b           0 b      20.27 Gb           0 b           435  
                                          aten::reshape         0.09%       6.260ms         0.70%      47.092ms      21.503us       0.000us         0.00%      49.579ms      22.639us           0 b           0 b      20.22 Gb           0 b          2190  
                                            aten::zeros         0.14%       9.347ms         1.73%     115.910ms     107.225us       0.000us         0.00%      49.246ms      45.556us          84 b           0 b      61.93 Gb           0 b          1081  
                                              aten::add         0.14%       9.325ms         0.66%      43.956ms      82.936us      48.639ms         1.91%      48.639ms      91.772us           0 b           0 b      19.09 Gb      19.09 Gb           530  
                            aten::thnn_conv_depthwise2d         0.01%     605.000us         0.07%       4.782ms      43.473us       0.000us         0.00%      46.337ms     421.245us           0 b           0 b      10.36 Gb           0 b           110  
                    aten::thnn_conv_depthwise2d_forward         0.05%       3.037ms         0.06%       4.177ms      37.973us      46.337ms         1.82%      46.337ms     421.245us           0 b           0 b      10.36 Gb      10.36 Gb           110  
void spatialDepthwiseConvolutionUpdateOutput<float, ...         0.00%       0.000us         0.00%       0.000us       0.000us      46.337ms         1.82%      46.337ms     421.245us           0 b           0 b           0 b           0 b           110  
void cudnn::cnn::wgrad_alg0_engine<float, 512, 6, 5,...         0.00%       0.000us         0.00%       0.000us       0.000us      45.196ms         1.78%      45.196ms     695.323us           0 b           0 b           0 b           0 b            65  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      39.583ms         1.56%      39.583ms     179.923us           0 b           0 b           0 b           0 b           220  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us      39.274ms         1.55%      39.274ms     561.057us           0 b           0 b           0 b           0 b            70  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      37.324ms         1.47%      37.324ms     169.655us           0 b           0 b           0 b           0 b           220  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      37.270ms         1.47%      37.270ms     169.409us           0 b           0 b           0 b           0 b           220  
                                      aten::bitwise_and         0.05%       3.467ms         0.23%      15.345ms      34.875us      18.351ms         0.72%      36.702ms      83.414us           0 b           0 b      11.39 Gb           0 b           440  
                                              aten::sum         0.11%       7.442ms         0.72%      48.495ms     151.547us      30.316ms         1.19%      30.316ms      94.737us           0 b           0 b      48.19 Mb       1.50 Kb           320  
                                             aten::add_         0.16%      10.653ms         1.26%      84.322ms      83.405us      30.138ms         1.19%      30.138ms      29.810us           0 b           0 b           0 b           0 b          1011  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      29.988ms         1.18%      29.988ms      95.200us           0 b           0 b           0 b           0 b           315  
void nhwcToNchwKernel<float, float, float, true, fal...         0.00%       0.000us         0.00%       0.000us       0.000us      28.469ms         1.12%      28.469ms      99.891us           0 b           0 b           0 b           0 b           285  
                                        aten::clamp_min         0.05%       3.498ms         0.30%      20.174ms      46.916us      14.163ms         0.56%      28.326ms      65.874us           0 b           0 b      18.55 Gb           0 b           430  
void xmma_new::gemm::kernel<xmma_new::implicit_gemm:...         0.00%       0.000us         0.00%       0.000us       0.000us      26.340ms         1.04%      26.340ms     405.231us           0 b           0 b           0 b           0 b            65  
                                          ReluBackward0         0.02%       1.196ms         0.47%      31.212ms     145.172us       0.000us         0.00%      22.283ms     103.642us           0 b           0 b       9.27 Gb           0 b           215  
                               aten::threshold_backward         0.05%       3.503ms         0.45%      30.016ms     139.609us      22.283ms         0.88%      22.283ms     103.642us           0 b           0 b       9.27 Gb       9.27 Gb           215  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.800ms         0.86%      21.800ms     198.182us           0 b           0 b           0 b           0 b           110  
                                          aten::__and__         0.01%     503.000us         0.14%       9.046ms      41.118us       0.000us         0.00%      18.351ms      83.414us           0 b           0 b       5.70 Gb           0 b           220  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      18.351ms         0.72%      18.351ms      83.414us           0 b           0 b           0 b           0 b           220  
                                       aten::zeros_like         0.01%     649.000us         0.49%      33.087ms     157.557us       0.000us         0.00%      17.687ms      84.224us           0 b           0 b      22.59 Gb           0 b           210  
void cudnn::ops::scalePackedTensor_kernel<float, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      17.509ms         0.69%      17.509ms      83.376us           0 b           0 b           0 b           0 b           210  
void cutlass::Kernel<cutlass_tensorop_s1688fprop_pre...         0.00%       0.000us         0.00%       0.000us       0.000us      17.453ms         0.69%      17.453ms     232.707us           0 b           0 b           0 b           0 b            75  
                                           ViewBackward         0.02%       1.397ms         0.24%      16.374ms      24.998us       0.000us         0.00%      17.350ms      26.489us           0 b           0 b      10.25 Gb           0 b           655  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      16.998ms         0.67%      16.998ms      44.266us           0 b           0 b           0 b           0 b           384  
                              AdaptiveMaxPool2DBackward         0.01%     507.000us         0.18%      11.968ms     108.800us       0.000us         0.00%      15.799ms     143.627us           0 b           0 b       8.21 Gb           0 b           110  
                     aten::adaptive_max_pool2d_backward         0.02%       1.530ms         0.17%      11.461ms     104.191us       9.410ms         0.37%      15.799ms     143.627us           0 b           0 b       8.21 Gb       8.21 Gb           110  
                                             aten::relu         0.03%       1.760ms         0.19%      12.736ms      59.237us       0.000us         0.00%      14.163ms      65.874us           0 b           0 b       9.27 Gb           0 b           215  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      14.163ms         0.56%      14.163ms      65.874us           0 b           0 b           0 b           0 b           215  
                                         ExpandBackward         0.01%     338.000us         0.19%      12.844ms     122.324us       0.000us         0.00%      10.750ms     102.381us           0 b           0 b      48.08 Mb           0 b           105  
void at::native::(anonymous namespace)::atomicadapti...         0.00%       0.000us         0.00%       0.000us       0.000us       9.410ms         0.37%       9.410ms      85.545us           0 b           0 b           0 b           0 b           110  
                                  ampere_cgemm_32x32_tn         0.00%       0.000us         0.00%       0.000us       0.000us       3.923ms         0.15%       3.923ms     784.600us           0 b           0 b           0 b           0 b             5  
void cudnn::bn_fw_tr_1C11_singleread<float, 512, fal...         0.00%       0.000us         0.00%       0.000us       0.000us       3.533ms         0.14%       3.533ms      33.648us           0 b           0 b           0 b           0 b           105  
void cudnn::bn_bw_1C11_singleread<float, 512, false,...         0.00%       0.000us         0.00%       0.000us       0.000us       3.502ms         0.14%       3.502ms      33.352us           0 b           0 b           0 b           0 b           105  
                           MaxPool2DWithIndicesBackward         0.00%      46.000us         0.00%     333.000us      66.600us       0.000us         0.00%       2.126ms     425.200us           0 b           0 b     540.00 Mb           0 b             5  
                 aten::max_pool2d_with_indices_backward         0.00%     113.000us         0.00%     287.000us      57.400us       1.717ms         0.07%       2.126ms     425.200us           0 b           0 b     540.00 Mb     540.00 Mb             5  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.007ms         0.08%       2.007ms       2.228us           0 b           0 b           0 b           0 b           901  
                        torch::autograd::AccumulateGrad         0.06%       4.005ms         1.31%      87.741ms     100.852us       0.000us         0.00%       1.828ms       2.101us           0 b           0 b    -765.50 Kb      -3.31 Mb           870  
void fft2d_r2c_32x32<float, false, 1u, false>(float2...         0.00%       0.000us         0.00%       0.000us       0.000us       1.720ms         0.07%       1.720ms     344.000us           0 b           0 b           0 b           0 b             5  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 6.695s
Self CUDA time total: 2.540s

